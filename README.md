# –î–∏–ø–ª–æ–º–Ω–∞ —Ä–æ–±–æ—Ç–∞
## üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
###  –ù–∞–∑–≤–∞ –¥–∏–ø–ª–æ–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏
**–†–æ–∑—Ä–æ–±–∫–∞ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –∞—Å–∏—Å—Ç—É–≤–∞–Ω–Ω—è –≤–æ–¥—ñ—è –¥–ª—è —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ –±–µ–∑–ø–µ–∫–∏ –ø—ñ–¥ —á–∞—Å –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏–º –∑–∞—Å–æ–±–æ–º**
###  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
- `main.py` ‚Äì –û—Å–Ω–æ–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç, —â–æ –∑–∞–ø—É—Å–∫–∞—î –≤–µ–±–∫–∞–º–µ—Ä—É —Ç–∞ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤—Ç–æ–º–∏.
- `processor.py` ‚Äì –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞: —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—è –æ–±–ª–∏—á—á—è, –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞–Ω—É –æ—á–µ–π/—Ä–æ—Ç–∞, –∞–Ω–∞–ª—ñ–∑ –≤—Ç–æ–º–∏.
- `face_parsing/` ‚Äì Git-—Å–∞–±–º–æ–¥—É–ª—å –∑ –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂–µ—é BiSeNet –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –æ–±–ª–∏—á—á—è.
- `fatigue_model_training/` ‚Äì –ü–∞–ø–∫–∞ –∑ –º–æ–¥–µ–ª–ª—é (`yawn_eye_model.pkl`) –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤—Ç–æ–º–∏.
- `prototypes/` ‚Äì –ü—Ä–æ—Ç–æ—Ç–∏–ø–∏ —Ç–∞ –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫–∏–π –∫–æ–¥:
  - `live_detection/` ‚Äì –ü—Ä–æ—Å—Ç–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ç–æ–º–∏.
  - `live_detection_with_image_segmentation/` ‚Äì –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –∑ –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂–µ–≤–æ—é —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—î—é.
- `requirements.txt` ‚Äì –°–ø–∏—Å–æ–∫ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫.
###  –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é —Ä–∞–∑–æ–º —ñ–∑ —Å–∞–±–º–æ–¥—É–ª—è–º–∏
```bash
git clone --recurse-submodules <–ê–î–†–ï–°–ê_–†–ï–ü–û–ó–ò–¢–û–†–Ü–Æ>
```
–í–∂–µ –∫–ª–æ–Ω—É–≤–∞–ª–∏ –±–µ–∑ —Å–∞–±–º–æ–¥—É–ª—ñ–≤?
```bash
git submodule update --init --recursive
```
###  –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
```bash
python -m venv fatigue_detection_env
source fatigue_detection_env/bin/activate   # –î–ª—è Linux/Mac
fatigue_detection_env\Scripts\activate.bat  # –î–ª—è Windows
```
###  –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```
###  –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤–∞–≥ –º–æ–¥–µ–ª–µ–π
- –í–∞–≥–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –æ–±–ª–∏—á—á—è (`resnet34.pt`) ‚ûú `prototypes/live_detection_with_image_segmentation/weights/`
- –ú–æ–¥–µ–ª—å –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (`yawn_eye_model.pkl`) ‚ûú `fatigue_model_training/`
###  –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–∏
```bash
python main.py --type simple
```
###  –ö–µ—Ä—É–≤–∞–Ω–Ω—è
| –ö–Ω–æ–ø–∫–∞ | –î—ñ—è                                 |
|--------|--------------------------------------|
| `0`    | –ü–æ–∫–∞–∑–∞—Ç–∏ –∑–≤–∏—á–∞–π–Ω–∏–π –≤—ñ–¥–µ–æ–ø–æ—Ç—ñ–∫       |
| `1`    | –ù–∞–∫–ª–∞—Å—Ç–∏ –º–∞—Å–∫—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –æ–±–ª–∏—á—á—è  |
| `2`    | –ü–æ–∫–∞–∑–∞—Ç–∏ –æ–±–ª–∞—Å—Ç—ñ —Ç–∞ —Å—Ç–∞—Ç—É—Å –≤—Ç–æ–º–∏    |
| `q`    | –í–∏–π—Ç–∏ –∑ –ø—Ä–æ–≥—Ä–∞–º–∏                    |
# Thesis
## üá¨üáß English
### Thesis Title
**Development of an Intelligent Driver Assistance System to Monitor Concentration and Safety While Driving**
### Project Structure
- `main.py` ‚Äì Main script for running real-time driver monitoring via webcam.
- `processor.py` ‚Äì Core logic: facial region segmentation, eye/mouth state classification, fatigue analysis.
- `face_parsing/` ‚Äì Git submodule containing BiSeNet for facial segmentation.
- `fatigue_model_training/` ‚Äì Contains training logic and the final model (`yawn_eye_model.pkl`) for classification of eye and mouth states.
- `prototypes/` ‚Äì Experimental code:
  - `live_detection/` ‚Äì Simple prototype for detecting fatigue.
  - `live_detection_with_image_segmentation/` ‚Äì Advanced prototype using semantic segmentation with helper scripts and notebooks.
- `requirements.txt` ‚Äì Required Python packages.
### Clone the Repository with Submodules
```bash
git clone --recurse-submodules <REPO_URL>
```
Already cloned without submodules?
```bash
git submodule update --init --recursive
```
### Create and Activate a Virtual Environment (Optional)
```bash
python -m venv fatigue_detection_env
source fatigue_detection_env/bin/activate   # Linux/Mac
fatigue_detection_env\Scripts\activate.bat  # Windows
```
###  Install Dependencies
```bash
pip install -r requirements.txt
```
###  Place the Model Weights
- Face segmentation weights (`resnet34.pt`) ‚ûú `prototypes/live_detection_with_image_segmentation/weights/`
- Classifier model (`yawn_eye_model.pkl`) ‚ûú `fatigue_model_training/`
###  Run the Application
```bash
python main.py --type simple
```
###  Controls
| Key | Action                      |
|-----|-----------------------------|
| `0` | Raw camera feed             |
| `1` | Show face segmentation mask |
| `2` | Show ROIs and fatigue state |
| `q` | Quit                        |
